# Migration `20200628161451-create_base_character_models`

This migration has been generated by Edvard Botten at 6/28/2020, 4:14:51 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "CharacterType" AS ENUM ('NPC', 'PLAYER');

CREATE TYPE "Size" AS ENUM ('TINY', 'SMALL', 'MEDIUM', 'LARGE', 'HUGE', 'GIGANTIC');

CREATE TYPE "Race" AS ENUM ('HUMAN', 'HALFLING', 'SKINWALKER', 'DWARF', 'GNOME');

CREATE TYPE "CharacterStat" AS ENUM ('ACROBATICS', 'APPRAISE', 'BLUFF', 'CLIMB', 'CRAFT_A', 'CRAFT_B', 'CRAFT_C', 'DIPLOMACY', 'DISABLE_DEVICE', 'DISGUISE', 'ESCAPE_ARTIST', 'FLY', 'HANDLE_ANIMAL', 'HEAL', 'INTIMIDATE', 'KNOWLEDGE_ARCANA', 'KNOWLEDGE_DUNGONEERING', 'KNOWLEDGE_ENGINEERING', 'KNOWLEDGE_GEOGRAPHY', 'KNOWLEDGE_HISTORY', 'KNOWLEDGE_LOCAL', 'KNOWLEDGE_NATURE', 'KNOWLEDGE_NOBILITY', 'KNOWLEDGE_PLANES', 'KNOWLEDGE_RELIGION', 'LINGUISTICS', 'PERCEPTION', 'PERFORM_A', 'PERFORM_B', 'PROFESSION_A', 'PROFESSION_B', 'RIDE', 'SENSE_MOTIVE', 'SLEIGHT_OF_HAND', 'SPELLCRAFT', 'STEALTH', 'SURVIVAL', 'SWIM', 'USE_MAGIC_DEVICE', 'SPELL_RESISTANCE', 'STRENGTH', 'DEXTERITY', 'CONSTITUTION', 'INTELLIGENCE', 'WISDOM', 'CHARISMA', 'INITIATIVE', 'ARMOR_CLASS', 'TOUCH_ARMOR_CLASS', 'FLAT_ARMOR_CLASS', 'CMB', 'CLD', 'BAB', 'HIT_POINTS', 'LAND_SPEED', 'WATER_SPEED', 'CLIMBS_PEED', 'BURROW_SPEED', 'FLY_SPEED');

CREATE TYPE "StatBonusSource" AS ENUM ('RACE', 'CLASS', 'SKILL', 'ABILITY');

CREATE TYPE "SkillType" AS ENUM ('ACROBATICS', 'APPRAISE', 'BLUFF', 'CLIMB', 'CRAFT_A', 'CRAFT_B', 'CRAFT_C', 'DIPLOMACY', 'DISABLE_DEVICE', 'DISGUISE', 'ESCAPE_ARTIST', 'FLY', 'HANDLE_ANIMAL', 'HEAL', 'INTIMIDATE', 'KNOWLEDGE_ARCANA', 'KNOWLEDGE_DUNGONEERING', 'KNOWLEDGE_ENGINEERING', 'KNOWLEDGE_GEOGRAPHY', 'KNOWLEDGE_HISTORY', 'KNOWLEDGE_LOCAL', 'KNOWLEDGE_NATURE', 'KNOWLEDGE_NOBILITY', 'KNOWLEDGE_PLANES', 'KNOWLEDGE_RELIGION', 'LINGUISTICS', 'PERCEPTION', 'PERFORM_A', 'PERFORM_B', 'PROFESSION_A', 'PROFESSION_B', 'RIDE', 'SENSE_MOTIVE', 'SLEIGHT_OF_HAND', 'SPELLCRAFT', 'STEALTH', 'SURVIVAL', 'SWIM', 'USE_MAGIC_DEVICE');

CREATE TABLE "public"."Character" (
"id" text  NOT NULL ,"level" integer  NOT NULL ,"name" text  NOT NULL ,"race" "Race" NOT NULL DEFAULT E'HUMAN',"size" "Size" NOT NULL ,"type" "CharacterType" NOT NULL DEFAULT E'NPC',
    PRIMARY KEY ("id"))

CREATE TABLE "public"."CharacterDetail" (
"age" text  NOT NULL ,"alginment" text  NOT NULL ,"characterId" text  NOT NULL ,"deity" text  NOT NULL ,"height" text  NOT NULL ,"homeland" text  NOT NULL ,"id" text  NOT NULL ,"weight" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."CharacterStatBonus" (
"characterId" text  NOT NULL ,"id" text  NOT NULL ,"source" "StatBonusSource" NOT NULL ,"target" "CharacterStat" NOT NULL ,"temporary" boolean  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."CharacterBaseStats" (
"armorClass" integer  NOT NULL DEFAULT 0,"bab" integer  NOT NULL DEFAULT 0,"burrowSpeed" integer  NOT NULL DEFAULT 0,"characterId" text  NOT NULL ,"charisma" integer  NOT NULL DEFAULT 0,"cld" integer  NOT NULL DEFAULT 0,"climbSpeed" integer  NOT NULL DEFAULT 0,"cmb" integer  NOT NULL DEFAULT 0,"constitution" integer  NOT NULL DEFAULT 0,"dexterity" integer  NOT NULL DEFAULT 0,"flatArmorClass" integer  NOT NULL DEFAULT 0,"flySpeed" integer  NOT NULL DEFAULT 0,"hitPoints" integer  NOT NULL DEFAULT 0,"id" text  NOT NULL ,"initiative" integer  NOT NULL DEFAULT 0,"intelligence" integer  NOT NULL DEFAULT 0,"landSpeed" integer  NOT NULL DEFAULT 0,"spellResistance" integer  NOT NULL DEFAULT 0,"strength" integer  NOT NULL DEFAULT 0,"touchArmorClass" integer  NOT NULL DEFAULT 0,"waterSpeed" integer  NOT NULL DEFAULT 0,"wisdom" integer  NOT NULL DEFAULT 0,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."SkillStatus" (
"characterSkillId" text  NOT NULL ,"classSkill" boolean  NOT NULL ,"id" text  NOT NULL ,"proficient" boolean  NOT NULL ,"type" "SkillType" NOT NULL ,"value" integer  NOT NULL DEFAULT 0,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."CharacterSkills" (
"characterId" text  NOT NULL ,"id" text  NOT NULL ,
    PRIMARY KEY ("id"))

CREATE UNIQUE INDEX "CharacterDetail_characterId" ON "public"."CharacterDetail"("characterId")

CREATE UNIQUE INDEX "CharacterBaseStats_characterId" ON "public"."CharacterBaseStats"("characterId")

CREATE UNIQUE INDEX "CharacterSkills_characterId" ON "public"."CharacterSkills"("characterId")

ALTER TABLE "public"."CharacterDetail" ADD FOREIGN KEY ("characterId")REFERENCES "public"."Character"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."CharacterStatBonus" ADD FOREIGN KEY ("characterId")REFERENCES "public"."Character"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."CharacterBaseStats" ADD FOREIGN KEY ("characterId")REFERENCES "public"."Character"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."SkillStatus" ADD FOREIGN KEY ("characterSkillId")REFERENCES "public"."CharacterSkills"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."CharacterSkills" ADD FOREIGN KEY ("characterId")REFERENCES "public"."Character"("id") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200628161451-create_base_character_models
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,220 @@
+datasource DS {
+  provider = "postgresql"
+  url = "***"
+}
+
+generator client {
+  provider      = "prisma-client-js"
+  binaryTargets = env("BINARY_TARGET")
+}
+
+enum CharacterType {
+  NPC
+  PLAYER
+}
+
+enum Size {
+  TINY
+  SMALL
+  MEDIUM
+  LARGE
+  HUGE
+  GIGANTIC
+}
+
+enum Race {
+  HUMAN
+  HALFLING
+  SKINWALKER
+  DWARF
+  GNOME
+}
+
+model Character {
+  id        String               @default(uuid()) @id
+  type      CharacterType        @default(NPC)
+  name      String
+  level     Int
+  race      Race                 @default(HUMAN)
+  size      Size
+  details   CharacterDetail
+  baseStats CharacterBaseStats
+  statBonus CharacterStatBonus[]
+  skills    CharacterSkills
+}
+
+model CharacterDetail {
+  id          String    @default(uuid()) @id
+  characterId String
+  character   Character @relation(fields: [characterId], references: [id])
+  age         String
+  alginment   String
+  height      String
+  weight      String
+  deity       String
+  homeland    String
+}
+
+// Base stats + skills
+enum CharacterStat {
+  ACROBATICS
+  APPRAISE
+  BLUFF
+  CLIMB
+  CRAFT_A
+  CRAFT_B
+  CRAFT_C
+  DIPLOMACY
+  DISABLE_DEVICE
+  DISGUISE
+  ESCAPE_ARTIST
+  FLY
+  HANDLE_ANIMAL
+  HEAL
+  INTIMIDATE
+  KNOWLEDGE_ARCANA
+  KNOWLEDGE_DUNGONEERING
+  KNOWLEDGE_ENGINEERING
+  KNOWLEDGE_GEOGRAPHY
+  KNOWLEDGE_HISTORY
+  KNOWLEDGE_LOCAL
+  KNOWLEDGE_NATURE
+  KNOWLEDGE_NOBILITY
+  KNOWLEDGE_PLANES
+  KNOWLEDGE_RELIGION
+  LINGUISTICS
+  PERCEPTION
+  PERFORM_A
+  PERFORM_B
+  PROFESSION_A
+  PROFESSION_B
+  RIDE
+  SENSE_MOTIVE
+  SLEIGHT_OF_HAND
+  SPELLCRAFT
+  STEALTH
+  SURVIVAL
+  SWIM
+  USE_MAGIC_DEVICE
+  SPELL_RESISTANCE
+  STRENGTH
+  DEXTERITY
+  CONSTITUTION
+  INTELLIGENCE
+  WISDOM
+  CHARISMA
+  INITIATIVE
+  ARMOR_CLASS
+  TOUCH_ARMOR_CLASS
+  FLAT_ARMOR_CLASS
+  CMB
+  CLD
+  BAB
+  HIT_POINTS
+  LAND_SPEED
+  WATER_SPEED
+  CLIMBS_PEED
+  BURROW_SPEED
+  FLY_SPEED
+}
+
+enum StatBonusSource {
+  RACE
+  CLASS
+  SKILL
+  ABILITY
+}
+
+model CharacterStatBonus {
+  id          String          @default(uuid()) @id
+  characterId String
+  character   Character       @relation(fields: [characterId], references: [id])
+  temporary   Boolean
+  source      StatBonusSource
+  target      CharacterStat
+}
+
+model CharacterBaseStats {
+  id              String    @default(uuid()) @id
+  characterId     String
+  character       Character @relation(fields: [characterId], references: [id])
+  spellResistance Int       @default(0)
+  strength        Int       @default(0)
+  dexterity       Int       @default(0)
+  constitution    Int       @default(0)
+  intelligence    Int       @default(0)
+  wisdom          Int       @default(0)
+  charisma        Int       @default(0)
+  initiative      Int       @default(0)
+  armorClass      Int       @default(0)
+  touchArmorClass Int       @default(0)
+  flatArmorClass  Int       @default(0)
+  cmb             Int       @default(0)
+  cld             Int       @default(0)
+  bab             Int       @default(0)
+  hitPoints       Int       @default(0)
+  landSpeed       Int       @default(0)
+  waterSpeed      Int       @default(0)
+  climbSpeed      Int       @default(0)
+  burrowSpeed     Int       @default(0)
+  flySpeed        Int       @default(0)
+}
+
+model SkillStatus {
+  id               String          @default(uuid()) @id
+  type             SkillType
+  characterSkillId String
+  characterSkill   CharacterSkills @relation(fields: [characterSkillId], references: [id])
+  value            Int             @default(0)
+  classSkill       Boolean
+  proficient       Boolean
+}
+
+enum SkillType {
+  ACROBATICS
+  APPRAISE
+  BLUFF
+  CLIMB
+  CRAFT_A
+  CRAFT_B
+  CRAFT_C
+  DIPLOMACY
+  DISABLE_DEVICE
+  DISGUISE
+  ESCAPE_ARTIST
+  FLY
+  HANDLE_ANIMAL
+  HEAL
+  INTIMIDATE
+  KNOWLEDGE_ARCANA
+  KNOWLEDGE_DUNGONEERING
+  KNOWLEDGE_ENGINEERING
+  KNOWLEDGE_GEOGRAPHY
+  KNOWLEDGE_HISTORY
+  KNOWLEDGE_LOCAL
+  KNOWLEDGE_NATURE
+  KNOWLEDGE_NOBILITY
+  KNOWLEDGE_PLANES
+  KNOWLEDGE_RELIGION
+  LINGUISTICS
+  PERCEPTION
+  PERFORM_A
+  PERFORM_B
+  PROFESSION_A
+  PROFESSION_B
+  RIDE
+  SENSE_MOTIVE
+  SLEIGHT_OF_HAND
+  SPELLCRAFT
+  STEALTH
+  SURVIVAL
+  SWIM
+  USE_MAGIC_DEVICE
+}
+
+model CharacterSkills {
+  id          String        @default(uuid()) @id
+  characterId String
+  character   Character     @relation(fields: [characterId], references: [id])
+  skills      SkillStatus[]
+}
```


